
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>GRR Rapid Response</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="GRR Rapid Response">

    <link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px;
      }
    </style>
    <link href="/css/rekall.css" rel="stylesheet">
    <link href="/css/asciidoc.css" rel="stylesheet">
    <link href="/css/treeview.css" rel="stylesheet">
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></sc\
ript>
    <![endif]-->
  </head>

  <body>



   <nav class="navbar navbar-inverse navbar-fixed-top"
     role="navigation">
     <div class="container-fluid">
       <div class="navbar-header">
         <a class="navbar-brand" href="#">GRR Rapid Response</a>
       </div>

       <div class="navbar-collapse collapse">
         <ul class="nav navbar-nav">

        <li>
          <a class="" href="/index.html">
            Home
          </a>
        </li>

        <li>
          <a class="" href="/docs.html">
            Documentation
          </a>
        </li>

        <li>
          <a class="" href="/faq.html">
            FAQ
          </a>
        </li>

         </ul>
         <form class="navbar-form navbar-right" role="search" action="/search.html">
           <div class="form-group">
             <input type="text" name="q" class="form-control" placeholder="Site Search">
           </div>
           <button type="submit" class="btn btn-default">
             <span class="glyphicon glyphicon-search"></span>
           </button>
         </form>
       </div> <!-- navbar-collapse -->
     </div> <!-- container-fluid -->
   </nav>

<div class="container-fluid">
<div class="row-fluid">
  <div class="col-md-2">
    
 <a href="/docs/index.html" class="btn btn-default btn-lg btn-block">
  <span class="glyphicon glyphicon-arrow-left"></span> docs
 </a>

 <a href='/docs/Users/index.html' class="btn btn-default btn-lg btn-block">
   Users
 </a>
 <p>
 <div class='css-treeview'>
   <ul class='nav nav-stacked'>
<li>
   <a href='/docs/Users/admin.html' class="tree-link activate_tooltip"  title="Administrator Documentation">
      Administrator D ...
   </a>
</li>

<li>
   <a href='/docs/Users/configuration.html' class="tree-link activate_tooltip"  title="GRR Configuration">
      GRR Configurati ...
   </a>
</li>

<li>
   <a href='/docs/Users/user_manual.html' class="tree-link activate_tooltip"  title="User Documentation">
      User Documentat ...
   </a>
</li>
</ul>
 </div>

  </div>
  <div class="col-md-8" >
    
<div id="header">
<h1>The GRR Configuration system</h1>
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>The GRR configuration system is the main way users can control and customize the
behavior of GRR components. Previous versions of GRR used command line flags to
configure components, however that became unwieldy with a lot of confusing and
often contradictory command line options embedded in various shell scripts. We
decided to replace the configuration system with a new file based system.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_overview">Overview.</h2>
<div class="sectionbody">
<div class="paragraph"><p>When software is written with the GRR configuration system, it can define
parameters that it is going to use. Parameters have the general form
<em>Section.parameter_name</em> where <em>Section</em> corresponds to the component which
defines related parameters. For example, the <em>Logging</em> subsystem can define
several parameters: <em>Logging.path</em>, <em>Logging.verbose</em> etc. The use of section
names ensures that different components can safely reuse the same parameter name
without clashes.</p></div>
<div class="paragraph"><p>In addition to the parameter name, it is possible to declare a helpful message,
to assist the user in understanding the purpose of this parameter. Parameters
are also strongly typed. For example we can find the following code:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.5
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>config_lib<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">DEFINE_float</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Client.rss_max"</span><span style="color: #990000">,</span> <span style="color: #993399">500</span><span style="color: #990000">,</span>
                        <span style="color: #FF0000">"Maximum memory footprint in MB."</span><span style="color: #990000">)</span>

config_lib<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">DEFINE_option</span></span><span style="color: #990000">(</span>type_info<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">PEMPrivateKey</span></span><span style="color: #990000">(</span>
    name<span style="color: #990000">=</span><span style="color: #FF0000">"Client.private_key"</span><span style="color: #990000">,</span>
    description<span style="color: #990000">=</span><span style="color: #FF0000">"Client private key in pem format. If not provided this "</span>
    <span style="color: #FF0000">"will be generated by the enrollment process."</span><span style="color: #990000">,</span>
    <span style="color: #990000">))</span></tt></pre></div></div>
<div class="paragraph"><p>The first definition declares the parameter <em>Client.rss_max</em> to be a float, with
a default value of 500.</p></div>
<div class="paragraph"><p>The second definition is more complex. It defines the <em>Client.private_key</em>
parameter as a <em>PEMPrivateKey</em> type info declaration. This declaration allows
the configuration system itself to verify that the parameter is a valid private
key in PEM format. There is now no need for the code to specifically test for
sanity of the private key. If the user provides an invalid or corrupt PEM
encoded key, it is caught immediately by the config system and the program
aborts. For example the following happens after removing a random character from
the <em>CA.certificate</em> PEM string:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>Traceback (most recent call last):
  File "grr/client/client.py", line 48, in &lt;module&gt;
    conf.StartMain(main)
  File "grr/client/conf.py", line 93, in StartMain
    main([sys.argv[0]])
......
  File "grr/lib/config_lib.py", line 467, in _VerifyParameters
    descriptor.Validate(value)
  File "grr/lib/rdfvalues/crypto.py", line 173, in Validate
    return self.ParseFromString(value)
  File "grr/lib/rdfvalues/crypto.py", line 185, in ParseFromString
    raise type_info.TypeValueError("Certificate %s is invalid." % self.name)
grr.lib.type_info.TypeValueError: Certificate CA.certificate is invalid.</tt></pre>
</div></div>
<div class="paragraph"><p>Since every parameter is defined in advance and has a default value, the
configuration file does not need to specify every parameter - only those which
should be changed from the default value. In order to see all declared
parameters and their default values, we can issue the <em>--config_help</em> command
line flag. This is analogous to the <em>--help</em> flag:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>Client.control_urls = ["http://www.example.com/control"]
   List of URLs of the controlling server.
* Value = ['http://localhost:8080/control']

Client.max_out_queue = 10240000
   Maximum size of the output queue.
* Value = 10240000</tt></pre>
</div></div>
<div class="paragraph"><p>We can see that <em>Client.control_urls</em> has a default value of
<a href="http://www.example.com/control">http://www.example.com/control</a>, it is used to specify the URL of the controlling
server, and currently (after reading the configuration files), the value is set
to <a href="http://localhost:8080/control">http://localhost:8080/control</a>. We can also see that Client.max_out_queue is
not changed from its default value.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration_file_organization">Configuration file organization.</h2>
<div class="sectionbody">
<div class="paragraph"><p>When GRR is installed on a system, a system wide, distribution specific,
configuration file is also installed (by default
<em>/etc/grr/grr_server.yaml</em>). This specifies the basic configuration of the GRR
service (i.e. various distribution specific locations). However, the
configuration typically needs to be updated with site specific parameters (for
example new crypto keys, the <em>Client.control_urls</em> setting to allow the client
to connect to the server etc.)</p></div>
<div class="paragraph"><p>In order to avoid having to trash the user customized configuration files when
GRR is updated in future, we write site specific configuration files into the
<em>Config.writeback</em> location (by default <em>/etc/grr/grr.local.yaml</em>). This local
file only contains those parameters which are changed from the defaults, or the
system configuration file.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img alt="Note" src="data:image/png;base64,
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" />
</td>
<td class="content">
<div class="paragraph"><p>The system configuration file is never modified, all updated configurations are
always written to the writeback location. Do not edit the system configuration
file as changes in this file will be lost when GRR is upgraded.</p></div>
</td>
</tr></table>
</div>
<div class="paragraph"><p>Using the <em>--config_help</em> option will print all the supported options. This
allows users to figure out what parameters can be changed in the writeback
configuration file to override the system configuration, or the
defaults. Generally it is not required for users to edit many configuration
parameters. The most important parameters will be automatically set upon
installation.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration_contexts">Configuration Contexts.</h2>
<div class="sectionbody">
<div class="paragraph"><p>The next important concept to understand is that of configuration contexts. GRR
consists of many components, which share more of their configuration. Often,
however, we want to specify slight differences between each component. If we
were to write a separate configuration file say for each client version
(Currently, 3 operating systems, and 2 architectures) as well as for each
component (e.g. worker, enroller, frontend etc), we would end up with an
unmaintainable mess of many configuration files. It would make more sense to put
most of the common configuration parameters in the same file, and only specify
the different ones, depending on the component which is running.</p></div>
<div class="paragraph"><p>GRR introduces the concept of running context. The context is a list of
attributes about the currently running component. When the code accesses the
configuration system, the configuration system considers the currently running
context and returns the appropriate value of the required parameter.</p></div>
<div class="paragraph"><p>For example, consider the parameter <em>Logging.path</em> which specifies the location
of the log file. In a full GRR installation, we wish the admin UI to log to
<em>/var/log/grr/adminui.log</em> while the frontend should log to
<em>/var/log/grr/frontend.log</em>. We can therefore specify in the YAML config file:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>Logging.path: /var/log/grr/grr_server.log

AdminUI Context:
  Logging.path: /var/log/grr/adminui.log

HTTPServer Context:
  Logging.path: /var/log/grr/httpserver.log

Client Context:
  Logging.path: /var/log/grr/grr_client.log

  Platform:Windows:
    Logging.path: c:\\windows\\system32\\grr.log</tt></pre>
</div></div>
<div class="paragraph"><p>When the <em>adminui.py</em> program starts up, it populates its context with <em>AdminUI
Context</em>. This forces the configuration system to return the value specific to
this context. Note that other components, such as the worker will set a context
of <em>Worker Context</em>, which will not match any of the above overrides. Therefore
the worker will simply log to the default of <em>/var/log/grr/grr_server.log</em>.</p></div>
<div class="paragraph"><p>Note that it is possible to have multiple contexts defined at the same time. So
for example, the client running under windows will have the contexts, <em>Client
Context</em> and <em>Platform:Windows</em>, while a client running under Linux will have
the context <em>Client Context</em> and <em>Platform:Linux</em>. When several possibilities
can apply, the option which matches the most context parameters will be
selected. So in the above example, linux and osx clients will have a context
like <em>Client Context</em> and will select <em>/var/log/grr/grr_client.log</em>. On the
other hand, a windows client will also match the <em>Platform:Windows</em> context, and
will therefore select <em>c:\windows\system32\grr.log</em>.</p></div>
<div class="paragraph"><p>The following is a non-exhaustive list of available contexts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<em>Client Context</em>, <em>Worker Context</em>, <em>Console Context</em> etc. Are defined when
  running one of the main programs.
</p>
</li>
<li>
<p>
<em>Test Context</em> is defined when running unit tests.
</p>
</li>
<li>
<p>
<em>Arch:i386</em> and <em>Arch:amd64</em> are set when running a 32 or 64 bit binary.
</p>
</li>
<li>
<p>
<em>Installer Context</em> is defined when the windows installer is active
  (i.e. during installation)
</p>
</li>
<li>
<p>
<em>Platform:Windwos</em>, <em>Platform:Linux</em>, <em>Platform:Darwin</em> are set when running
  under these platforms.
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_parameter_expansions">Parameter Expansions</h2>
<div class="sectionbody">
<div class="paragraph"><p>The GRR configuration file format allows for expansion of configuration
parameters inside other parameters. For example consider the following
configuration file:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.5
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>Client<span style="color: #990000">.</span>name<span style="color: #990000">:</span> GRR

Nanny<span style="color: #990000">.</span>service_name<span style="color: #990000">:</span> <span style="color: #FF0000">"%(Client.name)service.exe"</span>
Nanny<span style="color: #990000">.</span>service_key_hive<span style="color: #990000">:</span> HKEY_LOCAL_MACHINE
Nanny<span style="color: #990000">.</span>service_key<span style="color: #990000">:</span> Software<span style="color: #990000">\\%(</span>Client<span style="color: #990000">.</span>name<span style="color: #990000">)</span>
Nanny<span style="color: #990000">.</span>child_command_line<span style="color: #990000">:</span> <span style="color: #990000">|</span>
  <span style="color: #990000">%(</span>child_binary<span style="color: #990000">)</span> <span style="color: #990000">--</span>config <span style="color: #FF0000">"%(Client.install_path)</span><span style="color: #CC33CC">\\</span><span style="color: #FF0000">%(Client.binary_name).yaml"</span></tt></pre></div></div>
<div class="paragraph"><p>The expansion sequence <em>%(parameter_name)</em> substitutes or expands the parameter
into the string. This allows us to build values automatically based on other
values. For example above, the <em>Nanny.service_name</em> will be
<em>GRRservice.exe</em> and the service_key will be set to <em>Software\GRR</em></p></div>
<div class="paragraph"><p>Expansion is very useful, but sometimes it gets in the way. For example, if we
need to pass literal % escape sequences. Consider the Logging.format parameter
which is actually a python format string:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.5
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>Logging<span style="color: #990000">.</span>format<span style="color: #990000">:</span> <span style="color: #990000">\%(</span>levelname<span style="color: #990000">\)</span>s <span style="color: #990000">\%(</span>module<span style="color: #990000">\)</span>s<span style="color: #990000">:\%(</span>lineno<span style="color: #990000">\)</span>s<span style="color: #990000">]</span> <span style="color: #990000">\%(</span>message<span style="color: #990000">\)</span>s  <span style="font-style: italic"><span style="color: #9A1900"># <img alt="1" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" /></span></span>
Logging<span style="color: #990000">.</span>format<span style="color: #990000">:</span> <span style="color: #990000">%</span>{<span style="color: #990000">%(</span>levelname<span style="color: #990000">)</span>s <span style="color: #990000">%(</span>module<span style="color: #990000">)</span>s<span style="color: #990000">:%(</span>lineno<span style="color: #990000">)</span>s<span style="color: #990000">]</span> <span style="color: #990000">%(</span>message<span style="color: #990000">)</span>s}       <span style="font-style: italic"><span style="color: #9A1900"># <img alt="2" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" /></span></span></tt></pre></div></div>
<div class="colist arabic"><table>
<tr><td><img alt="1" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" /></td><td>
This form escapes GRR&#8217;s special escaping sequence by preceding both opening
and closing sequences with the backslash character.
</td></tr>
<tr><td><img alt="2" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAAB7SURBVHja
HY6hFcMwDEQ/NDQsNSwU9Apdo7Cw0CsIBoZmhKzQEQJLDQsFVclHpHu693W429Zr7bu541Pg3kCm
Y0K75u9TEUPhuGgWU4mQDvieEaSQEnsT6zKPeZY0EUNtrHMCXvYUuSUg0PsMjUSvpysUT6OOSil9
izp/VNk1YJ8vf6MAAABDdEVYdFNvZnR3YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8w
MSBjcmlzdHlAbXlzdGljLmVzLmR1cG9udC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUAODBlYWU1
MjljOTRhN2Y0N2RlY2NmYWRhMjhhY2I5ZGblb7ENAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30A
AAAASUVORK5CYII=" /></td><td>
This variation uses the literal expansion sequence <em>%{}</em> to declare the
entire line as a literal string and prevent expansion.
</td></tr>
</table></div>
</div>
</div>
<div class="sect1">
<h2 id="_filtering">Filtering</h2>
<div class="sectionbody">
<div class="paragraph"><p>The configuration system may be extended to provide additional functionality
accessible from the configuration file. For example consider the following
configuration file:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.5
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>Logging<span style="color: #990000">.</span>path<span style="color: #990000">:</span> <span style="color: #FF0000">"%(HOME|env)/grr.log"</span>                             <span style="font-style: italic"><span style="color: #9A1900"># <img alt="1" src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" /></span></span></tt></pre></div></div>
<div class="colist arabic"><table>
<tr><td><img alt="1" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAAAAABzHgM7AAAAAmJLR0QAAKqNIzIAAABjSURBVHja
VY6xDcAwCAS/pPQaLim9QmajdOk2I2SNrMEIlARIoigU8Cek/4e7zdHaWOYOVwaoA6wOCw05Y7FB
gE0tIWQ+sBcwKM8qoD/wB5wGL8hjfdzWrh01GRp1hInGjDoXwHgsFuzBVLQAAABDdEVYdFNvZnR3
YXJlAEAoIylJbWFnZU1hZ2ljayA0LjIuOCA5OS8wOC8wMSBjcmlzdHlAbXlzdGljLmVzLmR1cG9u
dC5jb22RuiG4AAAAKnRFWHRTaWduYXR1cmUANThhMDcyZTA3MGRhMjJmNjEzNWNiZDNlNDE0NTQ2
ZjloaiHtAAAADnRFWHRQYWdlADEyeDEyKzArMIRtu30AAAAASUVORK5CYII=" /></td><td>
This expansion sequence uses the <em>env</em> filter which expands a value from the
environment. In this case the environment variable <em>HOME</em> will be expanded into
the <em>Logging.path</em> parameter to place the log file in the user&#8217;s home directory.
</td></tr>
</table></div>
<div class="paragraph"><p>There are a number of additional interesting filters. The <em>file</em> filter allows
including other files from the filesystem into the configuration file. For
example, some people prefer to keep their certificates in separate files rather
than paste them into the config file:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.5
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>CA<span style="color: #990000">.</span>certificate<span style="color: #990000">:</span> <span style="color: #FF0000">"%(/etc/certificates/ca.pem|file)"</span></tt></pre></div></div>
<div class="paragraph"><p>It is even possible to nest expansion sequences. For example this retrieves the
client&#8217;s private key from a location which depends on the client name:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.5
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>Client<span style="color: #990000">.</span>private_key<span style="color: #990000">:</span> <span style="color: #FF0000">"%(/etc/grr/client/%(Client.name)/private_key.pem|file)"</span></tt></pre></div></div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration_parsers">Configuration parsers</h2>
<div class="sectionbody">
<div class="paragraph"><p>The above describes the GRR configuration system as an yaml file and that is the
most commonly used format. However, configuration files are parsed using a
parser implementation which can be switched on demand. Currently there are a few
configuration parser implementations but additional ones can be added.</p></div>
<div class="paragraph"><p>The windows client implements a registry based configuration parser. This allows
GRR to use the registry instead of a flat file when running on windows. The
registry base parser is selected by using a URL of the form:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.5
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>client<span style="color: #990000">.</span>py --config reg<span style="color: #990000">:</span>//HKEY_LOCAL_MACHINE/Software/GRR</tt></pre></div></div>
<div class="paragraph"><p>Additionally an ini based configuration parser can be selected using a .conf
extension:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.5
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>client<span style="color: #990000">.</span>py --config /etc/grr<span style="color: #990000">.</span>conf</tt></pre></div></div>
<div class="paragraph"><p>Since ini files can not represent nested sections, it is impossible to specify
different parameters for different contexts. It is therefore not recommended to
use ini files for the full system config, but they are sufficient for use as a
write back location.</p></div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated 2014-08-26 16:05:39 CEST
</div>
</div>
<script src="/js/asciidoc.js"></script>
    <embed src="" width="100%" type="">
    </embed>
  </div>
  <div class="col-md-2 sidebar">
    <img src="/img/grr_logo.png" class="logo"></img>


  </div>
</div>
</div>
<script>
  $(window).resize(function(){
    var height = $(window).height() - 100;
    $('embed').height(height);
  });

  $(window).resize();
</script>
  <script>
   $(".activate_tooltip").tooltip();
  </script>
  </body>
</html>


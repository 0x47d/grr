
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>GRR Rapid Response</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="GRR Rapid Response">

    <link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px;
      }
    </style>
    <link href="/css/rekall.css" rel="stylesheet">
    <link href="/css/asciidoc.css" rel="stylesheet">
    <link href="/css/treeview.css" rel="stylesheet">
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></sc\
ript>
    <![endif]-->
  </head>

  <body>



   <nav class="navbar navbar-inverse navbar-fixed-top"
     role="navigation">
     <div class="container-fluid">
       <div class="navbar-header">
         <a class="navbar-brand" href="#">GRR Rapid Response</a>
       </div>

       <div class="navbar-collapse collapse">
         <ul class="nav navbar-nav">

        <li>
          <a class="" href="/index.html">
            Home
          </a>
        </li>

        <li>
          <a class="" href="/docs.html">
            Documentation
          </a>
        </li>

        <li>
          <a class="" href="/faq.html">
            FAQ
          </a>
        </li>

         </ul>
         <form class="navbar-form navbar-right" role="search" action="/search.html">
           <div class="form-group">
             <input type="text" name="q" class="form-control" placeholder="Site Search">
           </div>
           <button type="submit" class="btn btn-default">
             <span class="glyphicon glyphicon-search"></span>
           </button>
         </form>
       </div> <!-- navbar-collapse -->
     </div> <!-- container-fluid -->
   </nav>

<div class="container-fluid">
<div class="row-fluid">
  <div class="col-md-2">
    
 <a href="/docs/index.html" class="btn btn-default btn-lg btn-block">
  <span class="glyphicon glyphicon-arrow-left"></span> docs
 </a>

 <a href='/docs/Developers/index.html' class="btn btn-default btn-lg btn-block">
   Developers
 </a>
 <p>
 <div class='css-treeview'>
   <ul class='nav nav-stacked'>
<li>
   <a href='/docs/Developers/artifact_yaml_style.html' class="tree-link activate_tooltip"  title="Artifact YAML Style Guide.">
      Artifact YAML S ...
   </a>
</li>

<li>
   <a href='/docs/Developers/implementation.html' class="tree-link activate_tooltip"  title="Implementation Details.">
      Implementation  ...
   </a>
</li>
</ul>
 </div>

  </div>
  <div class="col-md-8" >
    
<div id="header">
<h1>Artifact YAML Style Guide</h1>
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>This style guide aims to ensure consistency and readbility for forensics
artifacts defined in <a href="http://www.yaml.org/spec/1.2/spec.html">YAML</a>.
The format is currently under development and likely to undergo significant
change. Eventually this style should be enforced in code.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_the_basics">The Basics</h2>
<div class="sectionbody">
<div class="paragraph"><p>Here&#8217;s a typical artifact definition:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>name: ApplicationEventLogEvtx
doc: Windows Application Event Log for Vista or newer systems.
collectors:
- collector_type: FILE
  args:
    path_list:
      - '%%environ_systemroot%%\System32\winevt\Logs\Application.evtx'
conditions: [os_major_version &gt;= 6]
labels: [Logs]
supported_os: [Windows]
urls: ['http://www.forensicswiki.org/wiki/Windows_XML_Event_Log_(EVTX)']</tt></pre>
</div></div>
<div class="ulist"><ul>
<li>
<p>
<strong>name</strong>: CamelCase name without spaces.
</p>
</li>
<li>
<p>
<strong>doc</strong>: First line is a short description of the artifact, mentioning
  important caveats.  If more description is necessary, use the
  <a href="#long-docs">long form</a>.
</p>
</li>
<li>
<p>
<strong>collectors</strong>: List of collectors and necessary arguments.  This is the key part of the artifact that describes
  the data on the client. See <a href="#collectors">the
  Collectors section</a> for more details.
</p>
</li>
<li>
<p>
<strong>conditions</strong>: Conditions that will apply to this artifact.
</p>
</li>
<li>
<p>
<strong>labels</strong>: List of labels.  Labels are used to logically group artifacts into
  categories like "Users", "Browser" etc.  A full list of available labels can
  be found in lib.artifact_lib.ARTIFACT_LABELS.
</p>
</li>
<li>
<p>
<strong>supported os</strong>: A list of OSes that this artifact applies to (Windows, Darwin,
  Linux).
</p>
</li>
<li>
<p>
<strong>urls</strong>: List of relevant urls that contain more detail about the artifact.
  Ideally forensicswiki.org links.
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_long_docs">Long docs</h2>
<div class="sectionbody">
<div class="paragraph"><p>Multi-line docs should use the Literal Style indicated by the |
character with a double newline between the short description and the longer
portion.  Explicit newlines (\n) should not be used:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>doc: |
  Collect windows run keys.

  Note users.sid will currently only expand to SIDs with profiles on the system,
  not all SIDs.</tt></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_collectors">Collectors</h2>
<div class="sectionbody">
<div class="paragraph"><p>The available collector types are defined in the Collector message in the <a href="https://code.google.com/p/grr/source/browse/proto/artifact.proto#10">artifact.proto</a>.</p></div>
<div class="paragraph"><p>Where collectors take a single argument with a single value, the {} form should
be used to save on line breaks:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>collectors:
- collector_type: FILE
  args: {path_list: [/var/log/wtmp]}</tt></pre>
</div></div>
<div class="paragraph"><p>Where there are multiple arguments, or the arguments have multiple values, the
longer form should be used:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>collectors:
- collector_type: COMMAND
  args:
    args: [-qa]
    cmd: /bin/rpm</tt></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><tt>collectors:
- collector_type: FILE
  args:
    path_list:
      - /root/.bashrc
      - /root/.cshrc
      - /root/.ksh
      - /root/.logout
      - /root/.profile
      - /root/.tcsh
      - /root/.zlogin
      - /root/.zlogout
      - /root/.zprofile
      - /root/.zprofile</tt></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_lists">Lists</h2>
<div class="sectionbody">
<div class="paragraph"><p>Generally use the short [] format for single-item lists that fit inside 80
characters to save on unnecessary line breaks:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>labels: [Logs]
supported_os: [Windows]
urls: ['http://www.forensicswiki.org/wiki/Windows_XML_Event_Log_(EVTX)']</tt></pre>
</div></div>
<div class="paragraph"><p>and the bulleted list form for multi-item lists or long lines:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>path_list:
  - 'HKEY_USERS\%%users.sid%%\Software\Microsoft\Windows\CurrentVersion\Run\*'
  - 'HKEY_USERS\%%users.sid%%\Software\Microsoft\Windows\CurrentVersion\RunOnce\*'
  - 'HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\*'
  - 'HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce\*'
  - 'HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnceEx\*'</tt></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_quotes">Quotes</h2>
<div class="sectionbody">
<div class="paragraph"><p>Quotes should not be used for doc strings, artifact names, and simple lists
like labels and supported_os.</p></div>
<div class="paragraph"><p>Paths and URLs should use single quotes to avoid the need for manual escaping.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>path_list: ['%%environ_temp%%\*.exe']
urls: ['http://www.forensicswiki.org/wiki/Windows_XML_Event_Log_(EVTX)']</tt></pre>
</div></div>
<div class="paragraph"><p>Double quotes should be used where escaping causes problems, such as
regular expressions:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>content_regex_list: ["^%%users.username%%:[^:]*\n"]</tt></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_conditions">Conditions</h2>
<div class="sectionbody">
<div class="paragraph"><p>Artifact conditions are implemented using the
<a href="https://code.google.com/p/objectfilter/">objectfilter</a> system that allows
you to apply complex conditions to the attributes of an object. Artifacts can
apply conditions to any of the Knowledge Base object attributes as defined in
<a href="https://code.google.com/p/grr/source/browse/proto/knowledge_base.proto">knowledge_base.proto</a>.</p></div>
<div class="paragraph"><p>Since OS conditions are a very common constraint, this has been provided as a
separate option "supported_os" to simplify syntax.  Under the hood, this:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>supported_os: [Windows, Linux, Darwin]</tt></pre>
</div></div>
<div class="paragraph"><p>is translated to objectfilter as:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>["os =='Windows'" OR "os=='Linux'" OR "os == 'Darwin'"]</tt></pre>
</div></div>
<div class="paragraph"><p>supported_os should be used when specifying os conditions, no quotes are
required.  Single quotes should be used for strings when writing conditions.</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>conditions: [os_major_version &gt;= 6 and time_zone == 'America/Los_Angeles']</tt></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_minimize_the_number_of_definitions_by_using_multiple_collectors">Minimize the Number of Definitions by Using Multiple Collectors</h2>
<div class="sectionbody">
<div class="paragraph"><p>To minimize the number of artifacts in the list, combine them using the
supported_os and conditions attributes where it makes sense. e.g. rather than
having FirefoxHistoryWindows, FirefoxHistoryLinux, FirefoxHistoryDarwin, do:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>name: FirefoxHistory
doc: Firefox places.sqlite files.
collectors:
- collector_type: FILE
  args:
    path_list:
      - %%users.localappdata%%\Mozilla\Firefox\Profiles\*\places.sqlite
      - %%users.appdata%%\Mozilla\Firefox\Profiles\*\places.sqlite
  supported_os: [Windows]
- collector_type: FILE
  args:
    path_list: [%%users.homedir%%/Library/Application Support/Firefox/Profiles/*/places.sqlite]
  supported_os: [Darwin]
- collector_type: FILE
  args:
    path_list: ['%%users.homedir%%/.mozilla/firefox/*/places.sqlite']
  supported_os: [Linux]
labels: [Browser]
supported_os: [Windows, Linux, Darwin]</tt></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_files">Files</h2>
<div class="sectionbody">
<div class="paragraph"><p>Artifact filenames should be of the form file_name.yaml</p></div>
<div class="paragraph"><p>Each file should have a comment at the top of the file with a one-line summary
of the artifacts contained in the file:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt># Windows specific artifacts.</tt></pre>
</div></div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated 2014-08-26 16:05:36 CEST
</div>
</div>
<script src="/js/asciidoc.js"></script>
    <embed src="" width="100%" type="">
    </embed>
  </div>
  <div class="col-md-2 sidebar">
    <img src="/img/grr_logo.png" class="logo"></img>


  </div>
</div>
</div>
<script>
  $(window).resize(function(){
    var height = $(window).height() - 100;
    $('embed').height(height);
  });

  $(window).resize();
</script>
  <script>
   $(".activate_tooltip").tooltip();
  </script>
  </body>
</html>

